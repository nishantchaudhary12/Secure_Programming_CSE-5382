#include<stdio.h>
#include<string.h>
unsigned userid;

int matches(char *username, char *userpass)
{
	char temp[8];   //Creating a temporary array for the password
	int pig=0;   //Creating a flag variable
	strcpy(temp,userpass);    //strcpy() is a vulnerable fucntion but copies the entered password into the temporary array
	if(strcmp(temp,"aish4207")==0)   //strcmp() compares the entered password with the default user's password
		pig=1;   // if it is true, the flag variable pig increases its value
		
	return pig;
}

void main(void)
{
	char username[20];    //Initializing a username buffer of size 20
	char userpass[8];    //Initializing a password buffer of size 8
	float bankbalance=5000.0;   //Initializing the bank account balance to 5000
	float webbalance=1000.0;   //Initializing the web digital account balance to 1000
	float amount=0.0;   //This is the amount the user may add or withdraw   
	float transferamount=0.0;   //This is the amount the user would want to transfer
	int opt;
	printf("****Welcome to the Online Banking System****\n");
	printf("Enter your Username:\n");
	scanf("%s",username);    //scanf() is a probable instance to enter malicious or garbage values into the online banking system
	printf("Enter your Password:\n");
	scanf("%s",userpass);    //scanf() is a probable instance to enter malicious or garbage values into the online banking system
	if(matches(username,userpass))   //Function call to autorize and compare passwords
	{
		printf("\n========= ACCESS GRANTED ========= \n\n");
		do
		{
			
			printf("Welcome user\n");
			printf("1. View my Bank Balance\n");
			printf("2. View my Web Balance\n");
			printf("3. Add money to my Web account\n");
			printf("4. Cash out to my bank account\n");
			printf("5. Transfer money to user\n");
			printf("6. Exit System\n");
			printf("Please enter your choice of operation\n");
			scanf("%d",&opt);
			switch(opt)
			{	case 1:
				printf("Current Bank Balance: %f\n",bankbalance );
				break;

				case 2:
				printf("Current Web Balance: %f\n",webbalance );
				break;

				case 3:
				printf("Enter amount to be added: \n");
				scanf("%f",&amount);
				if(amount<=bankbalance)
				{
					webbalance=webbalance+amount;   //Updating Web Balance
					bankbalance=bankbalance-amount;   //Updating Bank Balance
					printf("Added successfully!\n");
					printf("Current Web Balance: %f\n",webbalance );
					printf("Current Bank Balance: %f\n",bankbalance );
				}				
				else
				{
					printf("Unsuccessful - You have insufficient Bank balance!\n");
				}
				break;

				case 4:
				printf("Enter amount to cash out: \n");
				scanf("%f",&amount);
				if(amount<=webbalance)
				{
					bankbalance=bankbalance+amount;   //Updating Bank Balance
					webbalance=webbalance-amount;   //Updating Web Balance
					printf("Cashed out successfully!\n");
					printf("Current Web Balance: %f\n",webbalance );
					printf("Current Bank Balance: %f\n",bankbalance );
				}				
				else
				{
					printf("Unsuccessful - You have insufficient Web balance!\n");
				}
				break;

				case 5:
				printf("Please enter amount to be transferred:\n");
				scanf("%f",&transferamount);
				if(transferamount>webbalance && transferamount>0)   //Checks against balance
				{
					printf("Unsuccessful - You have insufficient Web balance!");
				}
				else
				{
					printf("Enter the user's ID to be transferred to:\n");
					scanf("%d",&userid);
					printf("The amount has been successfully transferred\n");
					webbalance=webbalance-transferamount;   //Updates Web Balance after successful transfer
					printf("Your current balance is now: %f\n",webbalance);	
				}
				break;

				case 6: 
				printf("Thank you for banking with us today!\n");
				printf("You have been safely logged out.\n");
				break;
			}	
		} while(opt!=6);
	}
	else
	{
		printf("The username or password is invalid.\n");
	}								

}
