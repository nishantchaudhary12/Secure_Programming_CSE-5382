#include<iostream>
#include<cstring>
#include<stdio.h>
#include<fstream>
using namespace std;
class Student{
	char studentName[50], majorName[50];
	char fileStudentName[50], fileMajorName[50];
	public:
	Student(){}
	void showStudents()
	{	
		cout<<"\nList of Students";
		ifstream file;
		file.open("StudentMajor.txt");
		while(!file.eof())
		{	
						
			file>>fileStudentName;
			if(file.eof()) break;
			cout<<"\n"<<fileStudentName;
			file.get();
		
			file>>fileMajorName;
			
			cout<<"\t"<<fileMajorName;
			file.get();
			
		}
		file.close();
	}
	void newStudent()
	{	
		ofstream file;
		file.open("StudentMajor.txt", ios::app);
		cout<<"\nEnter details of the new Student ";
		cout<<"\nEnter Student Name: ";
		cin>>studentName;
		cin.sync();
		strncpy(fileStudentName, studentName, sizeof(fileStudentName));
		fileStudentName[50] = '\0';
		file<<fileStudentName<<'\t';
		file.flush();
		cout<<"\nEnter Major Name: ";
		cin>>majorName;
		cin.sync();
		strncpy(fileMajorName, majorName, 50);
		fileMajorName[50] = '\0';
		file.flush();
		file<<fileMajorName;
		
		file<<'\n';
		file.close();
	}
	void searchMajor()
	{	
		char tempBuffer[50];
		//bool flag = false;
		cout<<"\nEnter Student Name: ";
		cin>>studentName;
		strcpy(tempBuffer, studentName);
		ifstream file;
		file.open("StudentMajor.txt");
		while(!file.eof())
		{
			file>>fileStudentName>>fileMajorName;
			if(file.eof()) break;
			if(strncmp(tempBuffer, fileStudentName, 50) == 0)
			{	//flag = true;
				cout<<"\nStudent-Major Found!";				cout<<"\n"<<fileStudentName<<'\t'<<fileMajorName;
				break;
			}
		}
	}
	
};
int main()
{	
	int choice;
	Student st;
	while(1){
	cout<<"\n*******Student Majors*******";
	cout<<"\n1. Add New Student\n2. Search Student's Major\n3. List Students\n4. Exit";
	cout<<"\nEnter choice: ";
	cin>>choice;
	switch(choice)
	{
		case 1: {st.newStudent();
			break;}
		case 2: {st.searchMajor();
			break;}
		case 3: {st.showStudents();
			break;}
		case 4: {exit(0);}
		default: cout<<"\nInvalid Choice";
	}
	}
	return 0;

}
		
